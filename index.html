<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brenden Ackerson, Lindsey Cook, Dominic Gallelli">
<meta name="dcterms.date" content="2022-11-07">

<title>Cross-Validation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cross-Validation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brenden Ackerson, Lindsey Cook, Dominic Gallelli </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 7, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Cross Validation is a key method used to assess model generalizability, which describes the extent which statistical models developed in one sample fit other samples from the same population. <span class="citation" data-cites="song2021making">(<a href="#ref-song2021making" role="doc-biblioref">Song, Tang, and Wee 2021</a>)</span>. Essentially the goal of cross validation is to mimic the prediction of future individuals from the population. Pioneering work of Stone and Geisser in the 1970’s and the 1980’s by Burman on leave-one- out cross validation set the stage for the current techniques of cross validation <span class="citation" data-cites="jung2015ak">(<a href="#ref-jung2015ak" role="doc-biblioref">Jung and Hu 2015</a>)</span>. Common techniques of cross validation include data splitting (the most common method) by the hold- out technique, random subsampling by Monte Carlo, k-folds and repeated k-folds, and leave-one-out methods. <span class="citation" data-cites="ahmed2019classification">(<a href="#ref-ahmed2019classification" role="doc-biblioref">Ahmed and Nandi 2019</a>)</span>.</p>
<p>The general process to cross validation is a 5 step process <span class="citation" data-cites="song2021making">(<a href="#ref-song2021making" role="doc-biblioref">Song, Tang, and Wee 2021</a>)</span>:</p>
<ol type="1">
<li><p>Split the data into a training set and test set</p></li>
<li><p>Fit a model to the training set and obtain the model parameters</p></li>
<li><p>Apply the fitted model to the test set and obtain prediction accuracy</p></li>
<li><p>Repeat steps one through three</p></li>
<li><p>Calculate the average cross-validation prediction accuracy across all the repetitions</p></li>
</ol>
<p>This process differs in the various cross-validation techniques by varying how the data is split and how many repetitions are preformed of the train and test cycles. The best cross validation technique considers the model’s bias or difference between the population parameter and the cross-validation estimate, the variance or uncertainty in the cross-validation estimates, and with the computation costs of the method.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p><strong>Hold Out Cross- Validation Technique (Ahmed, 2019)</strong>:This method tends to use defined splits for the training and test set, like a 90/10, 80/20, 70/30, 60/40. Or 50/50 train/test data split. This method tends to have issues with small data sets. <span class="citation" data-cites="jung2015ak">(<a href="#ref-jung2015ak" role="doc-biblioref">Jung and Hu 2015</a>)</span></p>
<p><strong>k-folds Cross-Validation Technique (Jung, 2015)</strong>:</p>
<ol type="1">
<li><p>Randomly and evenly split the data set into k-folds.</p></li>
<li><p>Use k-1 folds of data as the training set to fit the model</p></li>
<li><p>With the fitted models, predict the value of the response variable in the hold out fold (kth fold)</p></li>
<li><p>From the response variable in the hold-out fold, calculate the prediction error</p></li>
<li><p>Repeat steps 2-4 for k times, so each k fold is used as a hold-out</p></li>
<li><p>Compare the prediction performance measures to select the “best” model</p></li>
</ol>
<p><span class="citation" data-cites="jung2015ak">(<a href="#ref-jung2015ak" role="doc-biblioref">Jung and Hu 2015</a>)</span></p>
<p>Repeated k-folds Cross-Validation Technique <span class="citation" data-cites="song2021making">(<a href="#ref-song2021making" role="doc-biblioref">Song, Tang, and Wee 2021</a>)</span>: Extends the k-folds by conducing multiple repetitions, each using a different k fold split.</p>
<p><strong>Leave-one-out Cross-Validation Technique (Derryberry, 2014)</strong>: This method is a special case of the k- folds technique that systematically excludes each point in the data set and fits the model with all other n-1 points. This technique splits the data into sets of n-1 and 1, n times. For each observation, the cross- validation residual is the difference between the observation and the model predicted value.<span class="citation" data-cites="derryberry2014basic">(<a href="#ref-derryberry2014basic" role="doc-biblioref">Derryberry 2014</a>)</span></p>
<p><strong>Monte Carlo Cross-Validation Technique (Song, 2021)</strong>: Similar to a k-fold method, but a predefined proportion of the data is randomly selected to form the test set in each prepetition, and the remaining proportion forms the training set. The train-test process is repeated a predetermined number of times. <span class="citation" data-cites="wainer2021nested">(<a href="#ref-wainer2021nested" role="doc-biblioref">Wainer and Cawley 2021</a>)</span></p>
</section>
<section id="analysis-and-results" class="level2">
<h2 class="anchored" data-anchor-id="analysis-and-results">Analysis and Results</h2>
<section id="data-and-vizualisation" class="level3">
<h3 class="anchored" data-anchor-id="data-and-vizualisation">Data and Vizualisation</h3>
<p>This paper will look at two data sets and review the various cross-validation techniques on each linear model to determine which cross-validation method is optimal.</p>
<p>The first data set is WordsWithFriends (Stats2Data R package), and the linear model of WinMargin (the margin a player wins Words With Friends) will be modeled against various variables that could impact winning, such as if a player starts the game or passes, how many S titles and blank tiles he played, and if the player got the J, Q, X, or Z tiles. This data set contains 444 observations.</p>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 25%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Type</th>
<th>Characteristic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>WinMargin</td>
<td>Response</td>
<td>Numeric</td>
</tr>
<tr class="even">
<td>Start</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="odd">
<td>Ss</td>
<td>Predictor</td>
<td>Numeric</td>
</tr>
<tr class="even">
<td>BlanksNumber</td>
<td>Predictor</td>
<td>Numeric</td>
</tr>
<tr class="odd">
<td>J</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="even">
<td>Q</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="odd">
<td>X</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="even">
<td>Z</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
</tbody>
</table>
<p><a href="https://www.rdocumentation.org/packages/Stat2Data/versions/2.0.0/topics/WordsWithFriends">Link to Documentation for Wordwithfreinds data</a></p>
<p>The next data set this paper will review is the R data set, Backpack (Stats2Data package). This data set has 100 observations and will model the backpack weight to body weight ratio to various predictors such as if a person has back problems, what major, year in school, and credits taken, along with the sex of the wearer and if he/she is an undergraduate or graduate student.</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Type</th>
<th>Characteristic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ratio</td>
<td>Response</td>
<td>Numeric</td>
</tr>
<tr class="even">
<td>BackProblems</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="odd">
<td>Major</td>
<td>Predictor</td>
<td>Categorical, 41 levels</td>
</tr>
<tr class="even">
<td>Year</td>
<td>Predictor</td>
<td>Numeric (could change to categorical)</td>
</tr>
<tr class="odd">
<td>Sex</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="even">
<td>Status</td>
<td>Predictor</td>
<td>Categorical, 2 levels</td>
</tr>
<tr class="odd">
<td>Units</td>
<td>Predictor</td>
<td>Numeric</td>
</tr>
</tbody>
</table>
<p><a href="https://www.rdocumentation.org/packages/Stat2Data/versions/2.0.0/topics/Backpack">Link to Documentation for backpack data</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading packages </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Stat2Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="statistical-modeling" class="level3">
<h3 class="anchored" data-anchor-id="statistical-modeling">Statistical Modeling</h3>
</section>
<section id="conlusion" class="level3">
<h3 class="anchored" data-anchor-id="conlusion">Conlusion</h3>
</section>
</section>
<section id="references" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-ahmed2019classification" class="csl-entry" role="doc-biblioentry">
Ahmed, Hosameldin, and Asoke K Nandi. 2019. <span>“Classification Algorithm Validation.”</span>
</div>
<div id="ref-derryberry2014basic" class="csl-entry" role="doc-biblioentry">
Derryberry, DeWayne R. 2014. <em>Basic Data Analysis for Time Series with r</em>. John Wiley &amp; Sons.
</div>
<div id="ref-jung2015ak" class="csl-entry" role="doc-biblioentry">
Jung, Yoonsuh, and Jianhua Hu. 2015. <span>“AK-Fold Averaging Cross-Validation Procedure.”</span> <em>Journal of Nonparametric Statistics</em> 27 (2): 167–79.
</div>
<div id="ref-song2021making" class="csl-entry" role="doc-biblioentry">
Song, Q Chelsea, Chen Tang, and Serena Wee. 2021. <span>“Making Sense of Model Generalizability: A Tutorial on Cross-Validation in r and Shiny.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 4 (1): 2515245920947067.
</div>
<div id="ref-wainer2021nested" class="csl-entry" role="doc-biblioentry">
Wainer, Jacques, and Gavin Cawley. 2021. <span>“Nested Cross-Validation When Selecting Classifiers Is Overzealous for Most Practical Applications.”</span> <em>Expert Systems with Applications</em> 182: 115222.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>